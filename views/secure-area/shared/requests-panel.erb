<link rel="stylesheet" href="/css/pages/dashboard-panels/notifications.css">
<div id="notification-panel">
  <h1>Requests</h1>
  
      <table>
      <thead>
        <tr>
            <th scope="col">Mentee Name </th>
            <th scope="col">Mentor Name</th>
            <th scope="col">Request</th>
            <th scope="col">Date</th>
        </tr>
      </thead>

      <tbody>
        <% if not @requests.nil?%>
          <% @requests.each do |req| %>
            <tr>
              <td><%= Users.where(id: req.mentee_id).first.full_name %> </td>
              <td><%= Users.where(id: req.mentor_id).first.full_name %> </td>
              <td><%= req.application_text %></td>
              <td><%= req.date_time %></td>
              <td colspan="2">
                <form action="/dashboard/requests" method="post" style="display: inline;">
                  <input type="hidden" name="requestid" value="<%= req.request_id %>">
                  <% if not @user.user_status == 'mentee' then %>
                    <button type="submit" name="decision" value="accept">Accept</button>
                    <button type="submit" name="decision" value="deny">Deny</button>
                  <% end %>
                </form>
              </td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>

  <% if not @accepted_requests.nil? and not @accepted_requests.empty? then %>
    <h1>Active Matches</h1>
    <form action="/dashboard/withdraw-request" method="post">
        <table>
        <thead>
          <tr>
            <th scope="col">Mentee Name </th>
            <th scope="col">Mentor Name</th>
            <th scope="col">Request</th>
            <th scope="col">Date</th>
            <th scope="col">View Profile</th>
            <th scope="col">Reqest to Withdraw</th>
          </tr>
        </thead>

        <tbody>
          <% @accepted_requests.each do |req| %>
            <tr>
              <td><%= Users.where(id: req.mentee_id).first.full_name %> </td>
              <td><%= Users.where(id: req.mentor_id).first.full_name %> </td>
              <td><%= req.application_text %></td>
              <td><%= req.date_time %></td>
            
              <% if @user.user_status == 'mentee' then %>
                <td><a class="button_link" href="/dashboard/profile-page?id=<%=req.mentor_id%>">View Profile</a>
                <td><button class="withdraw_request" name="withdraw_from_id" value="<%= req.mentor_id %>" action="submit">Request to Withdraw</td>
              <% else %>
                <td><a class="button_link" href="/dashboard/profile-page?id=<%=req.mentee_id%>">View Profile</a>
                <td><button class="withdraw_request" name="withdraw_from_id" value="<%= req.mentee_id %>" action="submit">Request to Withdraw</td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </form>
  <% end %>
  
</div>